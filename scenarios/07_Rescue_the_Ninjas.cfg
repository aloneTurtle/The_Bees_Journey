#textdomain wesnoth-The_Bees_Journey

# wmllint: local spellings GRAAAAAAH!! GRAAH! DRA

[scenario]
    id=07_Rescue_the_Ninjas
    name= _ "Rescue the Ninjas"

    next_scenario=08_Encounter_with_Truth
    map_file=07_Rescue_the_Ninjas.map

    {TURNS 26 24 22}
    {DEFAULT_SCHEDULE}

    {INTRO_AND_SCENARIO_MUSIC "knolls.ogg" "siege_of_laurelmor.ogg"}
    {EXTRA_SCENARIO_MUSIC "battlecry.ogg"}
    {EXTRA_SCENARIO_MUSIC "breaking_the_chains.ogg"}

    [story]
        [part]
            background="portraits/drakes/fighter.webp"
            scale_background=no
            story= _ "<i>“I know your clan and its home. The crest engraved on that bracelet is unmistakably that of the northeastern tribe. I’d have no trouble guiding you there. Do you wish so?”</i>"
        [/part]
        [part]
            background="portraits/drakes/fighter.webp"
            scale_background=no
            story= _ "<i>“In my honest opinion, Dragochan, you should return to the world of drakes. Besides, someone in your home might know a cure for your memory-loss. However, it’s entirely up to you.”</i>"
        [/part]
        [part]
            story= _ "What Dilan proposed was very surprising. Dragochan pondered for a moment, then made his answer clear. <i>“I’m not returning. I’ll accompany the bees on their journey.”</i>"
        [/part]
        [part]
            story= _ "Marie and Noaille worried about him, while Kaldyn was simply puzzled. This was a chance Dragochan would likely never get again. Yet he stubbornly insisted on devoting himself to Marie, his savior."
        [/part]
        [part]
            background="data/campaigns/The_Rise_Of_Wesnoth/images/story/trow_intro_06.webp"
            story= _ "A few days later, the boat departed from the island where Dilan lived, carrying the party and this drake, who remained loyal to the debt of gratitude."
            show_title=yes
        [/part]
    [/story]

    [side]
        side=1
        controller=human
        team_name=heroes
        user_team_name= _ "team_name^Marie"

        type=Princess Bee
        id=Marie
        name= _ "Marie"
        unrenamable=yes
        canrecruit=yes

        recruit=Bee,Drone

        {FLAG_VARIANT long}
        {GOLD 160 140 120}
        {INCOME 4 2 0}
    [/side]

    [side]
        side=2
        controller=ai
        team_name=enemies
        user_team_name= _ "team_name^Kushark"

        type=Fire Dragon
        id=Kushark
        name= _ "Kushark"
        canrecruit=yes

        recruit=Fire Guardian,Fire Wraith

        {FLAG_VARIANT6 ragged}
        {GOLD 280 320 360}
        {INCOME 18 20 22}

        [ai]
            grouping=no
            aggression=0.6
            caution=0.2
            [goal]
                name=target
                [criteria]
                    id=Marie
                [/criteria]
                value=8
            [/goal]
            [goal]
                name=target
                [criteria]
                    id=Kojiro
                [/criteria]
                value=8
            [/goal]
        [/ai]
    [/side]

    [side]
        side=3
        controller=ai
        team_name=heroes
        user_team_name= _ "team_name^Ninjas"

        type=Ninja
        id=Kojiro
        name= _ "Kojiro"
        canrecruit=yes

        recruit=Young Ninja

        {GOLD 120 100 80}
        {INCOME 6 4 2}

        [ai]
            grouping=no
            passive_leader=yes
            [goal]
                name=protect_unit
                [criteria]
                    id=Yoshie
                [/criteria]
                value=8
            [/goal]
            [goal]
                name=protect_unit
                [criteria]
                    id=Kojiro
                [/criteria]
                value=4
            [/goal]
        [/ai]
    [/side]

    [side]
        side=4
        controller=ai
        team_name=yeti
        user_team_name= _ "team_name^Yeti"

        no_leader=yes
        hidden=yes

        recruit=Yeti

        {FLAG_VARIANT6 ragged}

        # Default is one recruited Yeti, but giving gold increases to two
        gold=210
        {NO_INCOME}

        [ai]
            grouping=no
            aggression=0.8
            caution=0.2
            [goal]
                name=target
                [criteria]
                    id=Kushark
                [/criteria]
                value=4
            [/goal]
            [goal]
                name=target
                [criteria]
                    id=Marie
                [/criteria]
                value=8
            [/goal]
        [/ai]
    [/side]

    {STARTING_VILLAGES_ALL 2}
    {STARTING_VILLAGES 1 3}
    {STARTING_VILLAGES 3 3}

    [event]
        name=prestart
        [objectives]
            [objective]
                description= _ "Rescue Yoshie from the cage"
                condition=win
            [/objective]

            [objective]
                description= _ "Death of Marie"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Noaille"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Dragochan"
                condition=lose
            [/objective]
            [objective]
                description= _ "Destruction of Kaldyn"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Kojiro"
                condition=lose
            [/objective]

            {TURNS_RUN_OUT}

            [gold_carryover]
                bonus=yes
                carryover_percentage=40
            [/gold_carryover]
        [/objectives]

#ifdef EASY
        {LOYAL_UNIT 2 (Fire Guardian) 25 25} {GUARDIAN}
        {LOYAL_UNIT 2 (Fire Guardian) 30 22} {GUARDIAN}
#else
        {LOYAL_UNIT 2 (Fire Wraith) 25 25} {GUARDIAN}
        {LOYAL_UNIT 2 (Fire Wraith) 30 22} {GUARDIAN}
#endif
        {LOYAL_UNIT 2 (Fire Wraith) 29 26} {GUARDIAN}
        {LOYAL_UNIT 2 (Fire Wraith) 31 26} {GUARDIAN}

        {PLACE_IMAGE "scenery/wreck-2.png" 5 2}

        # Yoshie
        {PLACE_IMAGE "misc/unknown-unit-shadow.png" 31 18}
        # {PLACE_IMAGE "items/cage.png" 31 18}

        [recall]
            id=Noaille
            x,y=7,3
        [/recall]
        [recall]
            id=Dragochan
            x,y=7,4
        [/recall]
        [recall]
            id=Kaldyn
            x,y=8,4
        [/recall]
        [recall]
            id=Clovis
            x,y=9,3
        [/recall]
        [recall]
            id=Imorin
            x,y=9,4
        [/recall]

        {MODIFY_UNIT (side=1) facing se}
    [/event]

    [event]
        name=start
        [message]
            speaker=narrator
            message= _ "The party had the misfortune of encountering a massive storm and was swept away by the wind and waves. They made a crash-landing on a large island cloaked in silvery white."
            image=wesnoth-icon.png
        [/message]
        [message]
            speaker=Marie
            message= _ "Everyone, are you okay? We barely managed to salvage the boat, but it looks like we won’t be able to sail for a little while."
        [/message]
        [message]
            speaker=Noaille
            message= _ "At least we’re alive. Yet is this really the earth? The cold makes my body ache..."
        [/message]
        [message]
            speaker=Kaldyn
            message= _ "I wonder if we should have stayed a little longer on that island of drakes."
        [/message]
        [message]
            speaker=Dragochan
            message= _ "Don’t you realize? They knew you were there. No drake would be happy to stay with the undead for long."
        [/message]
        [message]
            speaker=Kaldyn
            message= _ "(<i>looking uncomfortable</i>) Heh, my bad."
        [/message]
        [message]
            speaker=Kushark
            message= _ "<i><big>Who the hell are you guys? This is the island ruled by the great Kushark! Death awaits any who dare intrude without my blessing!</big></i>"
            sound=dwarf-laugh.wav
        [/message]
        [message]
            speaker=Noaille
            message= _ "There’s a dragon here! The legends were true after all."
        [/message]
        [message]
            speaker=Marie
            message= _ "Don’t say such things, King Kushark. Your fortress seems quite warm."
        [/message]
        [message]
            speaker=Kushark
            message= _ "<i><big>Of course, this is a castle I had specially built by ordering my slave to work on it.</big></i>"
        [/message]
        [message]
            speaker=Kojiro
            message= _ "Help us, wise and gentle insects! Since that monster arrived, the island’s peace has been shattered. Many of our families and friends have been killed, and our ninja traditions are on the verge of collapse."
        [/message]
        [message]
            speaker=Marie
            message= _ "How awful! Slavery should never exist!"
        [/message]
        [message]
            speaker=Kojiro
            message= _ "Our leader Yoshie is being held hostage by that bastard. Freeing her would completely turn the tide of battle!"
        [/message]

        {HIGHLIGHT_IMAGE 31 18 items/cage.png (misc/unknown-unit-shadow.png)}

        [message]
            speaker=Marie
            message= _ "For now, let’s fight to save the ninjas. To arms!"
        [/message]
        [message]
            speaker=Dragochan
            message= _ "Show them your samurai spirit. <small>Honestly, I’m not too keen on clashing with a drake relative, though...</small>"
        [/message]
    [/event]

    [event]
        name=recruit
        [filter]
            side=2
        [/filter]
        [message]
            speaker=Clovis
            message= _ "Interesting, so you’re fire-wielding too. But my magic is more powerful!"
            scroll=no
        [/message]
    [/event]

    [event]
        name=side 2 turn end
        [message]
            speaker=Dragochan
            message= _ "I know a thing or two about flames myself, but this is the first time I’ve ever seen so many fire spirits."
            scroll=no
        [/message]
    [/event]

    [event]
        name=turn 3

        [move_unit_fake]
            side=4
            type=Yeti
            x=29,29,29,29,28
            y=3,4,5,6,6
        [/move_unit_fake]
        [unit]
            type=Yeti
            id=Graugu
            name= _ "Graugu"
            canrecruit=yes
            side=4
            x,y=28,6
            facing=sw
        [/unit]

        [modify_side]
            side=4
            hidden=no
            income=10
        [/modify_side]

        [message]
            speaker=Graugu
            message= _ "<i><big>GRAAAAAAH!!</big></i>"
        [/message]
        [message]
            speaker=Marie
            message= _ "Oh my!"
        [/message]
        [message]
            speaker=Kushark
            message= _ "<i><big>Oh my!</big></i>"
        [/message]
        [message]
            speaker=Graugu
            message= _ "<i><big>ME KILL... DRAGON! AGAAH!!</big></i>"
        [/message]
        [message]
            speaker=Noaille
            message= _ "I’m not sure, but he seems to have an axe to grind with that dragon."
        [/message]
        [message]
            speaker=Dragochan
            message= _ "Couldn’t we bribe him with honey? Though it failed with Kaldyn."
        [/message]

        [message]
            speaker=Marie
            message= _ "Hmm, what should I do..."
            [option]
                label= _ "Yeti, I’ll give you 100 gold worth of natural honey!"
                [command]
                    [store_gold]
                        side=1
                        variable=current_gold
                    [/store_gold]

                    [if]
                        [variable]
                            name=current_gold
                            greater_than_equal_to=100
                        [/variable]
                        [then]
                            [modify_side]
                                side=4
                                team_name=heroes
                            [/modify_side]

                            [gold]
                                side=1
                                amount=-100
                            [/gold]
                            [gold]
                                side=4
                                amount=100
                            [/gold]

                            [message]
                                speaker=Graugu
                                message= _ "<i><big>ME BATTLE WITH BEES!!</big></i>"
                                sound=fist.ogg
                            [/message]
                        [/then]
                        [else]
                            [message]
                                speaker=Graugu
                                message= _ "<i><big>LIES NOT ENOUGH HONEY! ME KILL ALL!!</big></i>"
                                sound=yeti-hit.ogg
                            [/message]
                        [/else]
                    [/if]

                    {CLEAR_VARIABLE current_gold}
                [/command]
            [/option]
            [option]
                label= _ "I can’t give him honey, because it’s very precious."
                [command]
                    [message]
                        speaker=Graugu
                        message= _ "<i><big>GRAAH! ME KILL DRA... ALL!!</big></i>"
                        sound=yeti-hit.ogg
                    [/message]
                [/command]
            [/option]
        [/message]

        [message]
            speaker=Kushark
            message= _ "<i><big>Hmph! I’ll crush you all together!</big></i>"
        [/message]
    [/event]

    {PICKUPPABLE_ITEM ring_of_skirmisher 15 13 (
        side=1
    ) items/ring-silver.png
    _"Wearing this ring grants them the skirmisher ability and increased movement. Should $unit.name use it?"
    _"ring of skirmisher^Take it"
    _"ring of skirmisher^Leave it"
    _"$unit.name cannot use this ring! Let a other unit have it." (
        [object]
            name= _ "Ring of Skirmisher"
            image=items/ring-silver.png
            duration=forever
            description= _ "This ring enhances the wearer’s movement. It also grants the skirmisher ability."
            [effect]
                apply_to=movement
                increase=1
            [/effect]
            [effect]
                apply_to=new_ability
                [abilities]
                    {ABILITY_SKIRMISHER}
                [/abilities]
            [/effect]
        [/object]

        [sound]
            name=magic-missile-[1~3].ogg
        [/sound]
    )}

    [event]
        name=last breath

        [filter]
            id=Kojiro
        [/filter]

        [message]
            speaker=unit
            message= _ "After I die, there will be no one left to care for the young ninjas..."
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x,y=31,18
        [/filter]

        [message]
            speaker=unit
            message= _ "She’s here! Are you okay?"
        [/message]

        [remove_item]
            x,y=$x1,$y1
        [/remove_item]

        [redraw][/redraw]

        [unit]
            type=Red Ninja
            id=Yoshie
            name= _ "Yoshie"
            gender=female
            unrenamable=yes
            [modifications]
                {TRAIT_RESILIENT}
                {TRAIT_QUICK}

                {TRAIT_LOYAL}
                [+trait]
                    male_name=""
                    female_name=""
                [/trait]
            [/modifications]
            side=1
            x,y=32,17
        [/unit]

        [message]
            speaker=Yoshie
            message= _ "Yes! Thanks for helping me out!"
            [option]
                label= _ "Let’s retreat from here for now. Trust me, I have a plan."
                [command]
                    [message]
                        speaker=Kushark
                        message= _ "<i><big>Do you really think you can escape, you fool!</big></i>"
                    [/message]
                    [message]
                        speaker=Yoshie
                        message= _ "You’re more foolish for not realizing my trap."
                    [/message]

                    {THUNDER ()}

                    [message]
                        speaker=Kushark
                        message= _ "<i><big>A poison bomb?! When did you set―</big></i>"
                    [/message]
                    [message]
                        speaker=Yoshie
                        message= _ "It should work even better against reptiles..."
                    [/message]

                    [sound]
                        name=poison.ogg
                    [/sound]

                    {FLASH_RED (
                        [message]
                            speaker=Kushark
                            message= _ "<i><big>Run! This is dangerous!</big></i>"
                            sound={SOUND_LIST:DRAKE_HIT}
                        [/message]
                        [kill]
                            side=2
                            fire_event=no
                        [/kill]
                    )}

                    [message]
                        speaker=Noaille
                        message= _ "For someone who was acting so high and mighty, he sure took off in a flash. We’ll create a magical barrier here."
                    [/message]
                    [message]
                        speaker=Clovis
                        message= _ "It seems my turn has come!"
                    [/message]
                    [message]
                        speaker=Yoshie
                        message= _ "That monster will no longer threaten us. I am grateful to you."
                    [/message]

                    [endlevel]
                        result=victory
                        bonus=yes
                        {NEW_GOLD_CARRYOVER 40}
                    [/endlevel]
                [/command]
            [/option]
            [option]
                label= _ "Now is the only chance to defeat that monster!"
                [command]
                    {APPEND_MUSIC "cry_from_elensefar.ogg"}

                    [message]
                        speaker=Kojiro
                        message= _ "Our leader has returned! Forward, young ninjas!"
                    [/message]

                    [scroll_to_unit]
                        id=Yoshie
                    [/scroll_to_unit]

                    [objectives]
                        [objective]
                            description= _ "Defeat Kushark the Dragon"
                            condition=win
                        [/objective]

                        [objective]
                            description= _ "Death of Marie"
                            condition=lose
                        [/objective]
                        [objective]
                            description= _ "Death of Noaille"
                            condition=lose
                        [/objective]
                        [objective]
                            description= _ "Death of Dragochan"
                            condition=lose
                        [/objective]
                        [objective]
                            description= _ "Destruction of Kaldyn"
                            condition=lose
                        [/objective]
                        [objective]
                            description= _ "Death of Kojiro"
                            condition=lose
                        [/objective]

                        {TURNS_RUN_OUT}

                        [gold_carryover]
                            bonus=yes
                            carryover_percentage=40
                        [/gold_carryover]
                    [/objectives]

                    [gold]
                        side=3
                        amount=60
                    [/gold]
                [/command]
            [/option]
        [/message]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Kushark
        [/filter]
        [message]
            speaker=unit
            message= _ "<i><big>This</big> is <small>absurd...</small></i>"
        [/message]
    [/event]
    [event]
        name=die
        [filter]
            id=Kushark
        [/filter]

        [if]
            [variable]
                name=second_unit.id
                contains="Dragochan"
            [/variable]
            [then]
                [message]
                    speaker=narrator
                    message= _ "Dragochan has taken over Kushark’s power!"
                    image=wesnoth-icon.png
                    sound=fire.wav
                [/message]

                {VARIABLE_OP second_unit.max_hitpoints add 40}
                {VARIABLE second_unit.hitpoints $second_unit.max_hitpoints}

                [unstore_unit]
                    variable=second_unit
                    text= _ "+40 hp"
                    {COLOR_WHITE}
                    find_vacant=no
                [/unstore_unit]

                [message]
                    speaker=Dragochan
                    message= _ "Oh, I’m bursting with strength... The day I become the true Lord Dragon is perhaps near."
                    sound=fire.wav
                [/message]

                {ACHIEVE s07}
            [/then]
        [/if]

        [endlevel]
            result=victory
            bonus=yes
            {NEW_GOLD_CARRYOVER 40}
        [/endlevel]
    [/event]

    [event]
        name=victory

        [message]
            speaker=Kojiro
            message= _ "Thank you! This island is saved! What true samurai are you people!"
        [/message]

        [if]
            [have_unit]
                id=Yoshie
                search_recall_list=no
            [/have_unit]
            [then]
                [recall]
                    id=Yoshie
                    x,y=8,19
                [/recall]
            [/then]
        [/if]

        [message]
            speaker=Yoshie
            message= _ "Kojiro, I’ve got an idea..."
        [/message]
        [message]
            speaker=Kojiro
            message= _ "What?"
        [/message]
        [message]
            speaker=Yoshie
            message= _ "I’ve decided to travel with these bees for a while! So you’ll be leading this island."
        [/message]
        [message]
            speaker=Kojiro
            message= _ "... Seriously? Bu-but Yoshie..."
        [/message]
        [message]
            speaker=Yoshie
            message= _ "Watching the home is a piece of cake, no? Every experience with them will surely prove useful to our skills!"
        [/message]
        [message]
            speaker=Kojiro
            message= _ "However, whether they will allow you or not is―"
        [/message]
        [message]
            speaker=Noaille
            message= _ "If you can lend us even a little strength, we would rather welcome."
        [/message]
        [message]
            speaker=Kojiro
            message= _ "... Umm... I understand well. But everyone, why not start by warming up your bodies?"
        [/message]
        [message]
            speaker=Marie
            message= _ "It really would help if possible, as we have someone who’s very sensitive to the cold."
        [/message]
        [message]
            speaker=Kaldyn
            message= _ "<i>That sounds a little like sarcasm directed at me...</i>"
            scroll=no
        [/message]
        [message]
            speaker=narrator
            message= _ "Yoshie has joined the party. She can be returned to the recall list just before defeat, so she won’t be lost."
            image=wesnoth-icon.png
        [/message]
    [/event]
[/scenario]
