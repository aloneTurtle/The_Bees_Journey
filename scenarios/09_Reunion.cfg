#textdomain wesnoth-The_Bees_Journey

[scenario]
    id=09_Reunion
    name= _ "Reunion"

    next_scenario=10_Daydream_Memories
    map_file=09_Reunion.map

    disallow_recall=yes
    victory_when_enemies_defeated=no

    turns=24
    {FIRST_WATCH}
    {FIRST_WATCH}
    {FIRST_WATCH}
    {FIRST_WATCH}
    {FIRST_WATCH}
    {FIRST_WATCH}
    {FIRST_WATCH}
    {FIRST_WATCH}
    {MIDNIGHT}
    {MIDNIGHT}
    {MIDNIGHT}
    {MIDNIGHT}
    {MIDNIGHT}
    {MIDNIGHT}
    {MIDNIGHT}
    {MIDNIGHT}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {DAWN}

    {INTRO_AND_SCENARIO_MUSIC "calm-before-storm.ogg" "breeze.ogg"}

    [story]
        [part]
            story= _ "The time was approaching when Marie’s words would come true: after wandering at sea for several days, Dragochan and Kaldyn finally reached Gapas Island."
            show_title=yes
        [/part]
    [/story]

    [side]
        side=1
        controller=human
        team_name=heroes
        user_team_name= _ "team_name^Marie"

        type=Princess Bee
        id=Marie
        name= _ "Marie"
        unrenamable=yes
        canrecruit=yes

        recruit=Bee,Drone

        shroud=yes
        fog=yes

        {FLAG_VARIANT long}
        gold=0
        village_gold=0
        {NO_INCOME}
    [/side]

#define AVOID_BEES OWN_SIDE
    [attacks]
        invalidate_on_gamestate_change=yes
        [filter_own]
            side={OWN_SIDE}
        [/filter_own]
        [filter_enemy]
            [not]
                side=5
            [/not]
        [/filter_enemy]
    [/attacks]
#enddef

    [side]
        side=2
        controller=ai
        team_name=enemies
        user_team_name= _ "team_name^Hornets"

        type=Great Hornet
        id=Elgair
        name= _ "Elgair"
        canrecruit=yes

        recruit=Soulless

        share_vision=none

        {FLAG_VARIANT6 ragged}
        {GOLD 20 30 40}
        {INCOME 0 2 4}

        {KAMIKAZE_AI (
            passive_leader=yes

            {AVOID_BEES 2}
        )}
    [/side]

    {RECRUIT_UNIT_VARIATIONS 2 "Soulless" ant,spider}

    # Make sure they cannot reach quickly
    [event]
        name=side 2 turn refresh
        first_time_only=no

        [modify_unit]
            [filter]
                side=2
            [/filter]
            moves=3
        [/modify_unit]
    [/event]

    [side]
        side=3
        controller=ai
        team_name=enemies
        user_team_name= _ "team_name^Hornets"

        no_leader=yes
        hidden=yes

        fog=yes

        share_vision=none

        color=purple
        {FLAG_VARIANT6 ragged}

        [ai]
            ai_algorithm=idle_ai

            {AVOID_BEES 3}
        [/ai]
    [/side]

    [side]
        side=4
        controller=ai
        team_name=enemies
        user_team_name= _ "team_name^Hornets"

        no_leader=yes
        hidden=yes

        fog=yes

        share_vision=none

        color=purple
        {FLAG_VARIANT6 ragged}

        {KAMIKAZE_AI (
            {AVOID_BEES 4}
        )}
    [/side]

#undef AVOID_BEES

    # Temporary hive for bees
    [side]
        side=5
        controller=null
        team_name=heroes
        user_team_name= _ "team_name^Marie"

        no_leader=yes
        hidden=yes

        fog=yes

        share_vision=none

        color=red
        {FLAG_VARIANT long}
    [/side]

    {STARTING_VILLAGES 2 4}

    [event]
        name=prestart
        [objectives]
            [objective]
                description= _ "Return to Marie"
                condition=win
            [/objective]

            [objective]
                description= _ "Death of Dragochan"
                condition=lose
            [/objective]
            [objective]
                description= _ "Destruction of Kaldyn"
                condition=lose
            [/objective]

            {TURNS_RUN_OUT}

            [gold_carryover]
                bonus=no
                carryover_percentage=100
            [/gold_carryover]
        [/objectives]

        #
        # Initial player-side settings
        #

        [disallow_recruit]
            side=1
        [/disallow_recruit]

        [if]
            [have_unit]
                # wmllint: recognize Clovis
                id=Clovis
                search_recall_list=yes
            [/have_unit]
            [then]
                [recall]
                    id=Clovis
                    x,y=16,40
                [/recall]
                [recall]
                    id=Noaille
                    x,y=20,44
                [/recall]
            [/then]
            [else]
                [recall]
                    id=Noaille
                    x,y=16,40
                [/recall]
                [terrain]
                    x,y=20,40
                    terrain=Hh
                [/terrain]
            [/else]
        [/if]

        [role]
            role=lookout
            x,y=16,40
        [/role]

        [recall]
            id=Imorin
            x,y=17,40
        [/recall]
        [recall]
            id=Yoshie
            x,y=17,41
        [/recall]

        {MODIFY_UNIT (side=1) side 5}

        [capture_village]
            side=5
            x,y=14,44
        [/capture_village]
        [capture_village]
            side=5
            x,y=19,43
        [/capture_village]
        [capture_village]
            side=5
            x,y=18,38
        [/capture_village]

        [remove_shroud]
            side=1
            [filter]
                id=Marie
            [/filter]
            radius=1
        [/remove_shroud]
        [remove_shroud]
            side=1
            [filter]
                role=lookout
            [/filter]
            radius=2
        [/remove_shroud]

        # wmllint: recognize Dragochan
        {UNSTORE_UNIT Dragochan_store (x,y,fire_event=3,3,yes)}

        # wmllint: recognize Kaldyn
        {UNSTORE_UNIT Kaldyn_store (x,y,fire_event=4,2,yes)}

        # Slow Dragochan down a little
        [object]
            duration=scenario
            [filter]
                id=Dragochan
            [/filter]

            [effect]
                apply_to=movement_costs
                replace=no
                [movement_costs]
                    hills=1
                    mountains=1
                [/movement_costs]
            [/effect]
        [/object]

        # Set Dragochan as interim leader
        {MODIFY_UNIT (id=Dragochan) canrecruit yes}
        [remove_unit_overlay]
            id=Dragochan
            image=misc/hero-icon.png
        [/remove_unit_overlay]

        # Enemy subleader
        [unit]
            type=Great Hornet
            generate_name=yes
            side=2
            random_traits=no
            [modifications]
                {TRAIT_LOYAL_HERO_NOSLOT}
            [/modifications]
            x,y=20,21
            ai_special=guardian
        [/unit]

        #
        # Seekers
        #

        [random_placement]
            num_items={ON_DIFFICULTY 3 5 7}
            variable=loc
            min_distance=3
            [filter_location]
                terrain=*^F*
                x=4-19
                y=9-36
            [/filter_location]
            [command]
#ifdef HARD
                {RANDOM "Assault,Assault,Warrior"}
#else
                {RANDOM "Assault,Warrior,Warrior"}
#endif

                [unit]
                    side=3
                    type=$random Hornet
                    vision=3
                    x,y=$loc.x,$loc.y
                [/unit]

                {CLEAR_VARIABLE random}
            [/command]
        [/random_placement]
        [random_placement]
            num_items={ON_DIFFICULTY 3 5 7}
            variable=loc
            min_distance=3
            [filter_location]
                terrain=Hh^*,Ww^*,Ss^*,G*^*
                x=4-21
                y=13-36
            [/filter_location]
            [command]
                [unit]
                    side=3
                    type=Wraith
                    vision=3
                    x,y=$loc.x,$loc.y
                [/unit]

                # {RANDOM "yes,no,no"}

                # [if]
                #     [variable]
                #         name=random
                #         boolean_equals=yes
                #     [/variable]
                #     [then]
                #         [object]
                #             duration=scenario
                #             [filter]
                #                 x,y=$loc.x,$loc.y
                #             [/filter]

                #             [effect]
                #                 apply_to=new_ability
                #                 [abilities]
                #                     {ABILITY_NIGHTSTALK}
                #                 [/abilities]
                #             [/effect]
                #         [/object]
                #     [/then]
                # [/if]

                # {CLEAR_VARIABLE random}
            [/command]
        [/random_placement]

        {MODIFY_UNIT (side=1) facing se}
        {MODIFY_UNIT (side=2,5) facing nw}

        # Buckler flag
        {VARIABLE iron_buckler_acquired no}
    [/event]

    # This is a cutscene-like scenario, so it must not be too hard
    {FORCE_CHANCE_TO_HIT (side=4) (side=1) {ON_DIFFICULTY 20 30 40} ()}
    {FORCE_CHANCE_TO_HIT (side=1) (side=4) {ON_DIFFICULTY 80 70 60} ()}

    [event]
        name=start

        [sound]
            name=wail-sml.wav
        [/sound]

        [move_unit_fake]
            type=Assault Hornet
            side=4
            x=1,2,3,4,5,6
            y=5,5,6,5,6,6
        [/move_unit_fake]

        {DELAY 250}

        [sound]
            name=wail-long.wav
        [/sound]

        [move_unit_fake]
            type=Wraith
            side=4
            x=6,7,8,9
            y=5,5,4,5
        [/move_unit_fake]
        [move_unit_fake]
            type=Ghost
            side=4
            x=6,7,8
            y=5,6,6
        [/move_unit_fake]

        {DELAY 250}

        [message]
            speaker=Kaldyn
            message= _ "..."
        [/message]

        {DELAY 750}

        [message]
            speaker=Kaldyn
            message= _ "That was close. It’s already been a couple of days since I began casting the magic. I doubt I can keep us hidden in the night for much longer. We should leave this dangerous place while we still can."
        [/message]
        [message]
            speaker=Dragochan
            message= _ "Sure, Marie would be worried about us by now."
        [/message]
        [message]
            speaker=Kaldyn
            message= _ "I’m... not talking about going back to those insects. I’m saying that we should leave this island at once."
        [/message]
        [message]
            speaker=Dragochan
            message= _ "..."
        [/message]
        [message]
            speaker=Kaldyn
            message= _ "What? Are you expecting your drake friends to come all this way to your rescue? Once you turned down Dilan’s proposal, that chance should have gone up in smoke. Surely you knew that yourself?"
        [/message]
        [message]
            speaker=Kaldyn
            message= _ "Gathering whatever wood we can find around here should be enough to build a small raft. It won’t take so long if you and I do it together."
        [/message]
        [message]
            speaker=Dragochan
            message= _ "..."
        [/message]

        {DELAY 1000}

        [message]
            speaker=Dragochan
            message= _ "I will not abandon and betray the bees, nor will I indulge in your folly. What about you, lich? Eh, if you choose to leave on your own, I won’t stop you ― yet the moment you step into sight of the hornets, you’ll be swarmed in an instant. Listening to your wretched scream from afar might not be so bad, actually."
        [/message]
        [message]
            speaker=Kaldyn
            message= _ "..."
        [/message]
        [message]
            speaker=Dragochan
            message= _ "If you don’t like that, then follow me and go back to Marie."
        [/message]

        # Roaming enemies
        [micro_ai]
            side=2
            ai_type=big_animals
            action=add

            [filter]
                type=Soulless,Mudcrawler
            [/filter]
            [filter_location]
                x=4-21
                y=9-36
            [/filter_location]
        [/micro_ai]
    [/event]

    [event]
        name=attack
        [filter]
            race=undead
        [/filter]
        [filter_second]
            race=undead
        [/filter_second]

        [message]
            speaker=Kaldyn
            message= _ "Back when I bound the undead and made them serve me, they were all obedient to me. Now it feels like a distant past."
        [/message]
    [/event]
    [event]
        name=attack end
        [filter]
            race=undead
        [/filter]
        [filter_second]
            race=undead
        [/filter_second]

        [message]
            speaker=Dragochan
            message= _ "That’s wrong at the bone. You weren’t mastering them ― just they were toying you."
        [/message]
    [/event]

    [event]
        name=turn 7

        {GENERIC_UNIT 2 (Mudcrawler) 15 3}
        {GENERIC_UNIT 2 (Mudcrawler) 15 4}
        {GENERIC_UNIT 2 (Mudcrawler) 16 3}
    [/event]
    [event]
        name=turn 15

        {GENERIC_UNIT 2 (Mudcrawler) 5 34}
        {GENERIC_UNIT 2 (Mudcrawler) 6 33}
        {GENERIC_UNIT 2 (Mudcrawler) 6 34}
    [/event]

    [event]
        name=sighted
        [filter]
            side=3
        [/filter]
        [filter_second]
            side=1
        [/filter_second]

        [redraw]
            clear_shroud=yes
        [/redraw]

        [fire_event]
            name=seeker warning
        [/fire_event]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1
            [filter_location]
                [filter]
                    side=3
                [/filter]
                radius=5
            [/filter_location]
        [/filter]

        [redraw]
            clear_shroud=yes
        [/redraw]

        [fire_event]
            name=seeker warning
        [/fire_event]
    [/event]

    [event]
        name=seeker warning
        [message]
            speaker=Kaldyn
            message= _ "I’ll warn you once more: the magic won’t last for much longer. And if we get too near the enemy, they’ll easily spot us out."
        [/message]
    [/event]

    [event]
        name=side turn
        first_time_only=no

        # Make their vision clearer for the player
        [modify_unit]
            [filter]
                side=3
            [/filter]
            moves=3
            max_moves=3
        [/modify_unit]
    [/event]

    #
    # Essentially the same as "Hide and Seek" in Liberty
    #
    [event]
        name=side 3 turn
        first_time_only=no

        [if]
            [have_unit]
                side=1
                [filter_vision]
                    visible=yes
                    side=3
                [/filter_vision]

                [or]
                    side=1
                    [filter_vision]
                        visible=yes
                        side=4
                    [/filter_vision]
                [/or]
            [/have_unit]
            [then]
                [modify_unit]
                    [filter]
                        side=3
                        [filter_location]
                            [filter]
                                side=1
                            [/filter]
                            radius=8
                        [/filter_location]
                    [/filter]
                    side=4
                    moves,max_moves=5,5
                [/modify_unit]
            [/then]
            [else]
                {MODIFY_UNIT (side=4) side 3}
            [/else]
        [/if]
    [/event]

    # TODO: In-scenario dialogue (roughly wrapping up Kaldyn's backstory)
    [event]
        name=turn 4

        {VARIABLE dialogue_count 0}

        [event]
            name=moveto,attack end
            first_time_only=no

            [filter]
                id=Dragochan,Kaldyn
            [/filter]

            [switch]
                variable=dialogue_count
                [case]
                    value=3

                    [message]
                        speaker=Dragochan
                        message= _ "In the end, Kaldyn, you were nothing but a coward who only cared about yourself. You never once made an effort to reconcile with the bees who spared your life. Even now, you refuse to return to their hive."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "Even if what you’re saying rings true, what’s wrong with that?"
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "You receive so much from others yet offer them nothing in return. You’ve merely kept up a false front before the bees, drifting along with the current. Despite being incapable of living alone, you never tried to cultivate a true friendship."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "I’ve always lived alone, all the time! Just by myself..."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "Then why on earth are you even here?!"
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "Because... I was defeated."
                    [/message]
                [/case]
                [case]
                    value=6

                    [message]
                        speaker=Dragochan
                        message= _ "You were defeated, yet you weren’t executed. So you mistake that as Marie giving you back your own stained life? If she had done so, I would have burned you to the ground without a second thought."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "Don’t tell me all at once, drake! My head’s spinning..."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "You’re alive, um... undead. But still, you’re standing here. Since Marie begged me not to destroy you."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "... Why would she do such a thing? She’s not even family to me."
                    [/message]
                [/case]
                [case]
                    value=11

                    [message]
                        speaker=Kaldyn
                        message= _ "I struggle to understand why you devote yourself so much to those insects, why you rush into danger to protect them. You had the chance to return to your home clan, yet you abandoned it so heedlessly. I’ve always found you puzzling."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "Of course, you’d never understand. You’re just a coward."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "Repeating such a monotonous argument will not deepen my understanding in the slightest."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "I know. From the moment you threw your own life out, or perhaps even before that, you stopped living with others. After all, you have no one close to you, no one you respect, no one you should protect and cherish."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "... Shut up."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "Or if your descent stems from the loss of such people, that too makes sense."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "What do you understand?! There’s nothing you know of me!"
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "That’s because you never try to reach out to anyone, because you never tell me or Marie anything about yourself. If you keep this up, neither understanding nor trust will ever grow."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "I... I just..."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "Marie had one more favor to ask of me. She wanted me to help you regain yourself as an honest existence. You should stop keeping a false front."
                    [/message]

                    {FADE_OUT_MUSIC}

                    {REPLACE_SCENARIO_MUSIC "transience.ogg"}
                    {APPEND_MUSIC "love_theme.ogg"}

                    [message]
                        speaker=Kaldyn
                        message= _ "I had... I had a sister centuries ago. She was my only remaining family, my everything. She... Flora became caught up in my interest for necromancy. When my undead study was discovered by the people of my home island, she shielded me selflessly. Because of that, she suffered the misfortune of being exiled alongside me. Even though she herself had committed no crime."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "After a hellish voyage and drifting, we two were washed ashore on an island. Yes, the very island where you and the bees first encountered me."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "... In other words, for you, she was the one you had to protect and cherish."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "But Flora is gone! Killed by the savage islanders!"
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "I should have been the only one to die. No matter how much I regret the past, she will never return from the Land of the Dead. I lost her, my everything, at that moment. My one and only family, who will never be born again. What first consumed me was rage and self-loathing ― but eventually, it turned into an empty heart. And in the end, there was nothing remaining."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "That’s nothing but a delusion. You’re just fooling yourself."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "Even so... that was enough for me. I’d always believed no one I could care for would ever appear again, and lived alone. However―"
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "Has something changed?"
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "Marie came and defeated me. Although there was no need whatsoever to set my rusted time in motion again! I was never meant to live with anyone or anything once more..."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "I’ll say it again and again: you can’t live alone. And no one has any choice but to live with others, wrong? Your sister couldn’t possibly want to see you like this now, as you yourself know better than me."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "Ah, I’ve heard enough of your story. What are you scheming? Are you trying to trick me into joining your devotion to those insects?"
                    [/message]
                [/case]
                [case]
                    value=15

                    {APPEND_MUSIC "journeys_end.ogg"}

                    [message]
                        speaker=Dragochan
                        message= _ "... Your name is Kaldyn, nothing more. But who gave you that name?"
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "My parents. My own family, who passed away long ago when I was young."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "Yes. Those who gave you your name and life. In your overly long times, have you ever considered your thanks to them?"
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "No way, drake... You’re..."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "Marie was the one who came up with a new name for me. She gave me a new life and meaning. That’s why I firmly vowed to repay her kindness in time. And she’s still giving me so much even now. So I plan to follow her lead and grow together with her. Just as a good child imitates their mother’s virtues and avoids her vices."
                    [/message]
                    [message]
                        speaker=Kaldyn
                        message= _ "But haven’t you done so for quite a long time...? You’ve repaid her kindness more than enough."
                    [/message]
                    [message]
                        speaker=Dragochan
                        message= _ "What do you think the worth of life is? Just what could possibly be returned to her in exchange for one’s life she gave?"
                    [/message]
                [/case]
            [/switch]

            {VARIABLE_OP dialogue_count add 1}

            [allow_undo][/allow_undo]
        [/event]
    [/event]

    [event]
        name=die
        [filter]
            id=Elgair
        [/filter]

        [message]
            speaker=Dragochan
            message= _ "This hornet seems to have wielded a buckler. If brought back to Marie, someone will surely find a use for it."
        [/message]

        {VARIABLE iron_buckler_acquired yes}

        {ACHIEVE s09}
    [/event]

    [event]
        name=sighted
        [filter]
            side=5
        [/filter]
        [filter_second]
            side=1
        [/filter_second]

        [message]
            speaker=Dragochan
            message= _ "Her encampment is coming in sight!"
            scroll=no
        [/message]

        [kill]
            side=2,3,4
            fire_event=no
        [/kill]

        [modify_side]
            side=1
            shroud=no
        [/modify_side]

        [lift_fog]
            [filter_side]
                side=1
            [/filter_side]

            [filter]
                role=lookout
            [/filter]
            radius=1
        [/lift_fog]

        [redraw]
            clear_shroud=yes
        [/redraw]

        # If Clovis is not present, Noaille serves as the lookout

        [message]
            role=lookout
            message= _ "Whoa, Dragochan! We were all worried for you..."
            female_message= _ "female^Whoa, Dragochan! We were all worried for you..."
        [/message]
        [message]
            speaker=Dragochan
            message= _ "It took us a little longer than expected, but we’re fine. How’s Marie anyway?"
        [/message]
        [message]
            role=lookout
            message= _ "She’s putting on a calm front before others, but she’s clearly shaken up... She must have been terribly worried for you two. Show your faces to her quickly. Also, we’re beginning to figure out the enemy ruling over the hornets. Marie and Noaille should explain."
            #po: She still holds secrets about Valois so she does not actively explain
            female_message= _ "female^She’s putting on a calm front before others, but she’s clearly shaken up... She must have been terribly worried for you two. Show your faces to her quickly. Also, we’re beginning to figure out the enemy ruling over the hornets."
        [/message]
        [message]
            speaker=Kaldyn
            message= _ "..."
        [/message]

        [modify_side]
            side=5
            share_vision=all
        [/modify_side]
        [redraw]
            clear_shroud=yes
        [/redraw]

        {DELAY 750}

        [message]
            speaker=Kaldyn
            message= _ "Dragochan... I still can’t be certain what I should do from now on. Perhaps I should regain myself, as Marie wishes. Or perhaps I should show some sincerity for the sake of the bees. Even so, I remain in doubt. After all, I was truly dead for so many centuries..."
        [/message]
        [message]
            speaker=Dragochan
            message= _ "Just realizing that fact means your time has headed in a good way. That should be enough for now. From now on, I won’t say anything else."
        [/message]
        [message]
            speaker=Kaldyn
            message= _ "... Very well."
        [/message]

        [message]
            speaker=narrator
            message= _ "Thus the party was reunited once more; Dragochan conferred with the bees and began gathering strength for the counterattack against Valois. Spring was slowly coming to Kaldyn’s frozen heart."
            image=wesnoth-icon.png
        [/message]

        [endlevel]
            result=victory
            bonus=no
            carryover_report=no
            {NEW_GOLD_CARRYOVER 100}
        [/endlevel]
    [/event]

    [event]
        name=victory

        {CLEAR_VARIABLE dialogue_count}

        # Reset Dragochan
        {MODIFY_UNIT (id=Dragochan) canrecruit no}
        [unit_overlay]
            id=Dragochan
            image=misc/hero-icon.png
        [/unit_overlay]

        #
        # Restore All
        #

        {MODIFY_UNIT (side=5) side 1}

        [allow_recruit]
            side=1
            type=Bee,Drone
        [/allow_recruit]
    [/event]

    [event]
        name=time over
        [message]
            speaker=Kaldyn
            message= _ "Dawn broke, and my magic wore off. A swarm of hornets has us surrounded!"
        [/message]
    [/event]
[/scenario]
