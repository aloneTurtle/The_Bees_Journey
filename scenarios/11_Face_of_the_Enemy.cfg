#textdomain wesnoth-The_Bees_Journey

[scenario]
    id=11_Face_of_the_Enemy
    name= _ "Face of the Enemy"

    next_scenario=12_The_Bees_Journey
    map_file=11_Face_of_the_Enemy.map

    {SCENARIO_MUSIC "nunc_dimittis.ogg"}
    {EXTRA_SCENARIO_MUSIC "into_the_shadows.ogg"}

    turns=unlimited
    {UNDERGROUND}

    # wmllint: validate-off
    [side]
        side=1
        controller=human
        team_name=bees
        user_team_name= _ "team_name^Bees"

        # wmllint: recognize Marie
        {CHARACTER_STATS_MARIE}

        shroud=yes

        color=red
        {FLAG_VARIANT long}
        {GOLD 180 160 140}
        {INCOME 4 2 0}

        [village]
            x,y=37,6
        [/village]
    [/side]
    # wmllint: validate-on

    [side]
        side=2
        controller=ai
        team_name=hornets
        user_team_name= _ "team_name^Hornets"

        type=Great Hornet
        id=Emelia
        name= _ "Emelia"
        canrecruit=yes

        recruit=Assault Hornet,Giant Hornet

        color=black
        {FLAG_VARIANT6 ragged}
        {GOLD 60 80 100}
        {INCOME 6 8 10}

        [ai]
            grouping=no
            [goal]
                name=target
                [criteria]
                    id=Marie
                [/criteria]
                value=6
            [/goal]
            aggression=0.95
            caution=0.15
            recruitment_pattern=mixed fighter,fighter
        [/ai]
    [/side]

    # wmllint: validate-off
    [side]
        side=3
        controller=ai
        team_name=hornets
        user_team_name= _ "team_name^Hornets"

        # wmllint: recognize Valois
        {CHARACTER_STATS_VALOIS_LV3}

        recruit=Ghost

        color=black
        {FLAG_VARIANT undead}
        {GOLD 20 40 60}
        {INCOME 16 18 20}

        [ai]
            grouping=no
            [goal]
                name=target
                [criteria]
                    id=Marie
                [/criteria]
                value=10
            [/goal]
            aggression=0.8
            caution=0.0
            recruitment_pattern=scout
        [/ai]
    [/side]
    # wmllint: validate-on

    [side]
        side=4
        controller=ai
        team_name=hornets
        user_team_name= _ "team_name^Hornets"

        type=Ghost
        id=Valkerel
        name= _ "Valkerel"
        canrecruit=yes

        recruit=Walking Corpse

        color=black
        {FLAG_VARIANT undead}
        {GOLD 20 30 40}
        {INCOME 2 4 6}

        [ai]
            grouping=no
            aggression=0.8
            caution=0.2
            recruitment_pattern=fighter
        [/ai]
    [/side]

    {RECRUIT_UNIT_VARIATIONS 4 "Walking Corpse" spider}

    [side]
        side=5
        controller=ai
        team_name=hornets
        user_team_name= _ "team_name^Hornets"

        type=Ghost
        id=Absara
        name= _ "Absara"
        canrecruit=yes

        recruit=Walking Corpse

        color=black
        {FLAG_VARIANT undead}
        {GOLD 20 30 40}
        {INCOME 2 4 6}

        [ai]
            grouping=no
            aggression=0.8
            caution=0.2
            recruitment_pattern=fighter
        [/ai]
    [/side]

    {RECRUIT_UNIT_VARIATIONS 5 "Walking Corpse" spider}

    [event]
        name=prestart
        [objectives]
            [objective]
                description= _ "Explore the inside"
                condition=win
            [/objective]

            [objective]
                description= _ "Death of Marie"
                condition=lose
            [/objective]

            [objective]
                description= _ "Death of Noaille"
                condition=lose
            [/objective]

            [objective]
                description= _ "Death of Dragochan"
                condition=lose
            [/objective]

            [objective]
                description= _ "Death of Kaldyn"
                condition=lose
            [/objective]

            [gold_carryover]
                carryover_percentage=0
            [/gold_carryover]

            {HAS_NO_TURN_LIMIT}
        [/objectives]

        [recall]
            id=Noaille
        [/recall]

        [recall]
            id=Dragochan
        [/recall]

        [recall]
            id=Kaldyn
        [/recall]

        {VARIABLE enemy_attacks 0}
        {VARIABLE first_enemy_defeated 0}
    [/event]

    [event]
        name=start
        [message]
            speaker=Noaille
            message= _ "Finally, we came to the bottom of the darkness."
        [/message]

        [message]
            speaker=Dragochan
            message= _ "So now you can have your mother's revenge. We must return to earth victorious."
        [/message]

        [message]
            speaker=Marie
            message= _ "Of course."
        [/message]
    [/event]

    [event]
        name=turn 2
        [message]
            speaker=Kaldyn
            message= _ "I feel very strong magic..."
        [/message]

        {QUAKE cave-in.ogg}

        [message]
            speaker=Kaldyn
            message= _ "No doubt. Marie, you will soon see the face of the enemy's master."
        [/message]

        [message]
            speaker=Marie
            message= _ "I think I have been waiting for this day ever since I left my homeland. But the truth is, I hate such destiny. Do you understand?"
        [/message]

        [message]
            speaker=Kaldyn
            message= _ "I cannot fathom the same sentiments. But at least I think Dragochan and I have been by your side all along."
        [/message]

        {QUAKE rumble.ogg}
    [/event]

    [event]
        name=attack
        first_time_only=no
        [filter]
            [not]
                side=1
            [/not]
        [/filter]

        [filter_second]
            id=Dragochan,Kaldyn
        [/filter_second]

        [switch]
            variable=enemy_attacks
            [case]
                value=0
                [message]
                    speaker=unit
                    message=_ "<b>Die, intruders!</b>"
                [/message]
            [/case]

            [case]
                value=1
                [message]
                    speaker=unit
                    message=_ "<b>Kill in the name of Mal-V'lois!</b>"
                [/message]
            [/case]
        [/switch]

        {VARIABLE_OP enemy_attacks add 1}
    [/event]

    [event]
        name=die
        [filter]
            side=2
            canrecruit=yes
        [/filter]

        {VARIABLE first_enemy_defeated 1}
    [/event]

    [event]
        name=side 1 turn
        first_time_only=no
        [switch]
            variable=first_enemy_defeated
            [case]
                value=1
                [message]
                    speaker=Dragochan
                    message=_ "Hey Marie, I wanted to ask you one thing... Do you ever get inexplicably lonely when you're on the road alone?"
                [/message]

                [message]
                    speaker=Marie
                    message=_ "That's not true. I always have Noaille next to me, and I have met Dragochan and Kaldyn. All along, I was never alone, and I still feel that way."
                [/message]

                [message]
                    speaker=Dragochan
                    message=_ "... You really have strong core. Something I don't have. It is very reassuring to see you like that."
                [/message]

                {QUAKE rumble.ogg}

                [message]
                    speaker=Marie
                    message=_ "I have always been encouraged by you. It's mutual."
                [/message]

                [message]
                    speaker=Dragochan
                    message=_ "No, it's your power that has allowed you to travel all this way. You should be proud of that. We are just trying to witness the whole thing."
                [/message]

                [message]
                    speaker=Kaldyn
                    message=_ "..."
                [/message]

                {CLEAR_VARIABLE first_enemy_defeated}
            [/case]
        [/switch]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=19-23
            y=24-27
        [/filter]

        [sound]
            name=fuse.ogg
        [/sound]

        [delay]
            time=2750
        [/delay]

        [color_adjust]
            red,green,blue=500,-500,-500
        [/color_adjust]

        [hide_unit]
            side=1,2,3,4,5
        [/hide_unit]

        [redraw]
            side=1
        [/redraw]

        [scroll_to]
            x,y=32,30
        [/scroll_to]

        [sound]
            name=explosion.ogg
        [/sound]

        [delay]
            time=250
        [/delay]

        [remove_shroud]
            side=1
        [/remove_shroud]

        [sound]
            name=explosion.ogg
        [/sound]

        [color_adjust]
            red,green,blue=0,0,0
        [/color_adjust]

        [unhide_unit]
            side=1,2,3,4,5
        [/unhide_unit]

        [redraw]
            side=1
        [/redraw]

        [music]
            name=vengeful.ogg
            immediate=yes
            append=no
        [/music]

        [music]
            name=frantic.ogg
            immediate=yes
            play_once=yes
        [/music]

        {QUAKE rumble.ogg}

        [sound]
            name=dwarf-laugh.wav
        [/sound]

        [delay]
            time=750
        [/delay]

        [message]
            speaker=Valois
            message= _ "<big>Finally you, Marie!</big>"
        [/message]

        [message]
            speaker=Marie
            message= _ "She is... She is my most hated enemy? Moreover, there is something nostalgic about her..."
        [/message]

        [message]
            speaker=Valois
            message= _ "Heh, heh, heh. My two wishes came true just now! Revenge against the kingdom and to see you again. Now, come here. My little Marie."
        [/message]

        [message]
            speaker=Valois
            message= _ "Noaille, you have been my detestable enemy, but I can commend you for bringing Marie up to this point. I shall put your corpse to effective use!"
        [/message]

        [message]
            speaker=Marie
            message= _ "Noaille? You know her?!"
        [/message]

        [message]
            speaker=Noaille
            message= _ "..."
        [/message]

        [message]
            speaker=Marie
            message= _ "Noaille! Answer, this is an order! Noaille!"
        [/message]

        [message]
            speaker=Kaldyn
            message= _ "Marie! Now is not the time to be blaming each other among your peers!"
        [/message]

        [message]
            speaker=Dragochan
            message= _ "Kaldyn is right, Marie, we have to defeat that unknown enemy here! She is dangerous!"
        [/message]

        [disallow_recruit]
            side=3
            type=Ghost
        [/disallow_recruit]

        [allow_recruit]
            side=3
            type=Hornet,Assault Hornet
        [/allow_recruit]

        [gold]
            side=3
            amount={ON_DIFFICULTY 120 140 160}
        [/gold]

        [objectives]
            [objective]
                description= _ "Defeat Mal-V'lois"
                condition=win
            [/objective]

            [objective]
                description= _ "Death of Marie"
                condition=lose
            [/objective]

            [objective]
                description= _ "Death of Noaille"
                condition=lose
            [/objective]

            [objective]
                description= _ "Death of Dragochan"
                condition=lose
            [/objective]

            [objective]
                description= _ "Death of Kaldyn"
                condition=lose
            [/objective]

            [gold_carryover]
                carryover_percentage=100
            [/gold_carryover]
        [/objectives]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Valois
        [/filter]

        [message]
            speaker=unit
            message= _ "Do you really think I'm going to die from this? See you soon - Marie!"
        [/message]

        [color_adjust]
            red,green,blue=500,-500,-500
        [/color_adjust]

        [hide_unit]
            side=1,2,3,4,5
        [/hide_unit]

        [redraw]
            side=1
        [/redraw]

        [kill]
            id=Valois
            animate=no
        [/kill]

        [kill]
            [not]
                side=1
            [/not]
            animate=no
        [/kill]

        [sound]
            name=explosion.ogg
        [/sound]

        [delay]
            time=250
        [/delay]

        [sound]
            name=explosion.ogg
        [/sound]

        [color_adjust]
            red,green,blue=0,0,0
        [/color_adjust]

        [unhide_unit]
            side=1,2,3,4,5
        [/unhide_unit]

        [redraw]
            side=1
        [/redraw]

        [music]
            name=silence.ogg
            immediate=yes
            append=no
        [/music]

        {QUAKE rumble.ogg}

        [sound]
            name=dwarf-laugh.wav
        [/sound]

        [delay]
            time=1250
        [/delay]

        [message]
            speaker=Marie
            message= _ "..."
        [/message]

        {CLEAR_VARIABLE enemy_attacks}

        [endlevel]
            result=victory
            bonus=no
            carryover_report=no
            {NEW_GOLD_CARRYOVER 0}
        [/endlevel]
    [/event]

    [event]
        name=victory
        {REPLACE_SCENARIO_MUSIC underground.ogg}

        [message]
            speaker=Marie
            message= _ "Noaille, what did she mean by what she said? Please, explain!"
        [/message]

        [message]
            speaker=Noaille
            message= _ "..."
        [/message]

        [message]
            speaker=Marie
            message= _ "Noaille!"
        [/message]

        [delay]
            time=750
        [/delay]

        [message]
            speaker=Noaille
            message= _ "... Marie, I... I..."
        [/message]

        [message]
            speaker=Dragochan
            message= _ "Hey, hey, what's going on? You've always been so calm! Why are you so flustered at this moment?"
        [/message]

        [message]
            speaker=Noaille
            message= _ "I..."
        [/message]

        [delay]
            time=1000
        [/delay]

        [message]
            speaker=Kaldyn
            message= _ "Noaille, I don't know the circumstances and I am in no position to be in the same boat as you. But in any case, there is no turning back now. Noaille?"
        [/message]

        [message]
            speaker=Noaille
            message= _ "..."
        [/message]

        [delay]
            time=750
        [/delay]

        [message]
            speaker=Noaille
            message= _ "I... I understand well. I will now tell you all about Marie and Valois and what happened between the Kingdom of Bees. Marie, this is probably very painful for you to hear."
        [/message]

        [message]
            speaker=Noaille
            message= _ "I was going to take this secret to my grave..."
        [/message]

        {FADE_TO_BLACK}

        [delay]
            time=1000
        [/delay]

        [message]
            speaker=Noaille
            message= _ "The sight of Mal-V'lois was clear to me. She is Valois, another Queen Melissa, and your real mother."
        [/message]

        [message]
            speaker=Kaldyn
            message= _ "<b>!</b>"
        [/message]

        [delay]
            time=500
        [/delay]

        [message]
            speaker=Marie
            message= _ "You are lying... My..."
        [/message]

        [message]
            speaker=Noaille
            message= _ "This is true."
        [/message]

        [delay]
            time=1000
        [/delay]

        [message]
            speaker=Noaille
            message= _ "It was still the time when ants and bees lived together on the island. Melissa, whom you know well, and that Valois were born as twins, Valois being the older sister. The two reigned over roughly half of the kingdom each."
        [/message]

        [delay]
            time=250
        [/delay]

        [message]
            speaker=Noaille
            message= _ "Valois was an extremely talented sorceress. But ... she was too ambitious. She began to study the power of the undead, which was forbidden. Gradually she became corrupted. Melissa and I noticed this and cooperated to expel her from the island. After the small war, she escaped."
        [/message]

        [message]
            speaker=Noaille
            message= _ "Her curse eventually overtook the entire island. Then the accursed bitter cold struck us. That winter was the cause of the ants being forced to leave the island."
        [/message]

        [message]
            speaker=Marie
            message= _ "No way... Belania never told me a word about that..."
        [/message]

        [delay]
            time=1000
        [/delay]

        [message]
            speaker=Noaille
            message= _ "You, the princess of Valois, were the only one left on the island. At that time, you had just emerged from the egg. Melissa took you in as her adopted daughter and I have decided to educate you so that you will be the gentle queen who will never be tainted by evil."
        [/message]

        [message]
            speaker=Marie
            message= _ "..."
        [/message]

        [delay]
            time=1000
        [/delay]

        [message]
            speaker=Noaille
            message= _ "I did not know what happened to Valois after that. However, I cannot deny the possibility that she had been wandering around in pursuit of her beloved daughter, and that she was on the road to destruction. And if she had targeted and attacked the kingdom in revenge, all of the events would make sense."
        [/message]

        [message]
            speaker=Kaldyn
            message= _ "..."
        [/message]

        {FADE_IN}

        [delay]
            time=1000
        [/delay]

        [message]
            speaker=Dragochan
            message= _ "Marie? Are you-"
        [/message]

        [message]
            speaker=Marie
            message= _ "..."
        [/message]

        [delay]
            time=750
        [/delay]

        [message]
            speaker=Marie
            message= _ "... All my life I knew nothing about it. I was deceived."
        [/message]

        [message]
            speaker=Noaille
            message= _ "Marie... I'm sorry..."
        [/message]

        [message]
            speaker=Marie
            message= _ "Noaille has nothing to apologize for. My mother is none other than the great Melissa. I must surely ... kill that Mal-V'lois."
        [/message]

        [message]
            speaker=Dragochan
            message= _ "Marie..."
        [/message]

        [delay]
            time=1000
        [/delay]

        [message]
            speaker=Marie
            message= _ "I have one favor to ask of everyone. I am going to face Mal-V'lois. So please let me go alone."
        [/message]

        [message]
            speaker=Noaille
            message= _ "That is reckless! Marie!"
        [/message]

        [hide_unit]
            id=Marie
        [/hide_unit]

        [message]
            speaker=Noaille
            message= _ "Marie!"
        [/message]

        [delay]
            time=750
        [/delay]

        [message]
            speaker=Noaille
            message= _ "..."
        [/message]

        [message]
            speaker=Dragochan
            message= _ "..."
        [/message]

        [message]
            speaker=Kaldyn
            message= _ "..."
        [/message]

        [delay]
            time=1000
        [/delay]

        [message]
            speaker=Kaldyn
            message= _ "Everyone-"
        [/message]
    [/event]

    {HERODEATH_MARIE}
    {HERODEATH_NOAILLE}
    {HERODEATH_DRAGOCHAN}
    {HERODEATH_KALDYN}
[/scenario]
